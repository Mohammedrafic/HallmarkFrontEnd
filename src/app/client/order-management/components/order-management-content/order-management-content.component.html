<app-button-group
  #systemGroup
  class="button-group system-buttons"
  *ngIf="isIRPFlagEnabled"
  [buttonOptions]="systemGroupConfig"
  (buttonChange)="changeSystem($event)"
></app-button-group>
<app-page-toolbar>
  <ng-container left>
    <div class="navigation-wrapper" appTabsMobileShadow>
      <div>
        <app-tabs-list
          class="table-tabs irp"
          *ngIf="activeSystem === OrderManagementIRPSystemId.IRP"
          #tabNavigation
          [tabConfig]="tabsListConfig"
          (changeTab)="irpTabSelected($event)"
        >
        </app-tabs-list>
        <app-tab-navigation
          class="table-tabs vms"
          *ngIf="activeSystem === OrderManagementIRPSystemId.VMS"
          #tabNavigation
          [hideTemplatesTab]="false"
          (selectedTab)="tabSelected($event)"
        >
        </app-tab-navigation>
      </div>
    </div>
  </ng-container>
  <ng-container right>
    <ng-container *ngIf="!isMobile">
      <div class="buttons-container">
        <app-search #search class="search" (inputKeyUpEnter)="searchOrders($event)"></app-search>
        <ng-container
          *ngIf="!(isContentTabletWidth || isMiddleTabletWidth)"
          [ngTemplateOutlet]="filterButton"
        ></ng-container>
        <app-tooltip-container
          *ngIf="!isActiveSystemIRP && !(isContentSmallDesktop || isMiddleTabletWidth)  && activeSystem != OrderManagementIRPSystemId.OrderJourney"
          [message]="toolTipMessage"
          [showToolTip]="!userPermission[userPermissions.CanCreateOrders]"
        >
          <button
            [disabled]="isActiveSystemIRP || !canCreateOrder || !userPermission[userPermissions.CanCreateOrders]"
            ejs-button
            appHideBeforeSyncfusionLoad
            (click)="openImportDialog()"
            class="e-outline"
          >
            <div class="button-import-container">Import<i-feather name="download" class="icon"></i-feather></div>
          </button>
        </app-tooltip-container>
        <!-- TODO (activeTab !== OrganizationOrderManagementTabs.Incomplete) - temporary solution for hiding button without functionality -->
        <button
          *ngIf="
            activeTab !== OrganizationOrderManagementTabs.OrderTemplates &&
            activeTab !== OrganizationOrderManagementTabs.Incomplete &&
            !isActiveSystemIRP &&
            !(isContentSmallDesktop || isMiddleTabletWidth)
          "
          ejs-dropdownbutton
          appHideBeforeSyncfusionLoad
          [items]="exportOptions"
          (select)="exportSelected($event)"
          id="importButton"
          cssClass="e-outline button-export"
          [disabled]="isActiveSystemIRP"
        >
          <div class="button-export-container">Export<i-feather name="upload" class="icon"></i-feather></div>
        </button>

        <button *ngIf="isActiveSystemIRP" ejs-dropdownbutton appHideBeforeSyncfusionLoad [items]="exportOptions" (select)="exportSelected($event)"
          id="importButton" cssClass="e-outline button-export" [disabled]="!canCreateOrderIRP || !userPermission[userPermissions.CanCreateOrdersIRP]">
          <div class="button-export-container">Export<i-feather name="upload" class="icon"></i-feather></div>
        </button>

        <ng-container
          *ngIf="!isActiveSystemIRP && (isContentSmallDesktop || isMiddleTabletWidth)"
          [ngTemplateOutlet]="smallMenuButton"
        >
        </ng-container>

        <app-tooltip-container
          *ngIf="!isMobile && isActiveSystemIRP"
          [message]="toolTipMessage"
          [showToolTip]="!userPermission[userPermissions.CanCreateOrdersIRP]"
        >
          <button
            [disabled]="!canCreateOrderIRP || !userPermission[userPermissions.CanCreateOrdersIRP]"
            ejs-button
            appHideBeforeSyncfusionLoad
            [isPrimary]="true"
            (click)="navigateToOrderForm()"
          >
            Create Order
          </button>
        </app-tooltip-container>

        <app-tooltip-container
          *ngIf="!isMobile && activeSystem!=OrderManagementIRPSystemId.OrderJourney && !isActiveSystemIRP"
          [message]="toolTipMessage"
          [showToolTip]="!userPermission[userPermissions.CanCreateOrders]"
        >
          <button
            [disabled]="!canCreateOrder || !userPermission[userPermissions.CanCreateOrders]"
            ejs-button
            appHideBeforeSyncfusionLoad
            [isPrimary]="true"
            (click)="navigateToOrderForm()"
          >
            Create Order
          </button>
        </app-tooltip-container>
      </div>
    </ng-container>
  </ng-container>
</app-page-toolbar>

<ng-container *ngIf="isIRPFlagEnabled">
  <ng-container *ngIf="activeSystem === OrderManagementIRPSystemId.All">
    <p class="help-text">Orders for the last 30 days</p>
  </ng-container>
</ng-container>

<ng-container *ngIf="isIRPFlagEnabled && activeSystem == OrderManagementIRPSystemId.IRP else vmsGridTemplate;">
  <div class="grid-table-container table-wrapper IRPgrid">
    <div class="mobile-group-button" *ngIf="isMobile">
      <ng-container [ngTemplateOutlet]="smallMenuButton"></ng-container>
    </div>
    <ag-grid-angular
      [columnDefs]="columnDefs"
      [rowData]="(ordersPage$ | async)?.items"
      [context]="context"
      [rowHeight]="rowHeight"
      [modules]="modules"
      [gridOptions]="gridOptions"
      [class.empty-table]="!(ordersPage$ | async)?.items?.length"
      [overlayNoRowsTemplate]="gridEmptyMessage"
      [rowSelection]="'multiple'"
      [domLayout]="gridDomLayout"
      class="ag-theme-alpine app-grid__component"
      (gridReady)="setGridApi($event)"
      (sortChanged)="gridSortHandler($event)"
      (rowClicked)="openIrpDetails($event)"
    >
    </ag-grid-angular>
  </div>
</ng-container>
<app-grid-pagination
  [currentPage]="currentPage"
  [pageSize]="pageSize"
  [totalRecordsCount]="activeSystem==OrderManagementIRPSystemId.OrderJourney ? (ordersJourneyPage$ | async)?.totalCount||0 : (ordersPage$ | async)?.totalCount||0"
  (navigateToPageEmitter)="gridPageChanged($event)"
  (pageSizeChangeEmitter)="gridPerPageChanged($event)"
></app-grid-pagination>

<ng-template #filterButton>
  <button
    ejs-button
    appHideBeforeSyncfusionLoad
    cssClass="e-outline button-filter"
    (click)="showFilters()"
  >
    <div class="filter-button-content">
      <span *ngIf="activeSystem != OrderManagementIRPSystemId.OrderJourney && filteredItems.length" class="e-badge e-badge-success e-badge-pill">{{filteredItems.length }}</span>
      <span *ngIf="activeSystem == OrderManagementIRPSystemId.OrderJourney && filteredOrdersJourneyItems.length" class="e-badge e-badge-success e-badge-pill">{{ filteredOrdersJourneyItems.length }}</span>
      Filters <i-feather name="sliders" class="icon"></i-feather>
    </div>
  </button>
</ng-template>

<ng-template #smallMenuButton>
  <ng-container *ngIf="(isMobile || isTablet)" [ngTemplateOutlet]="filterButton"></ng-container>
  <button
    ejs-dropdownbutton
    appHideBeforeSyncfusionLoad
    [items]="smallMenu"
    (select)="smallMenuSelected($event)"
    id="importButton"
    cssClass="e-outline menu-mobile"
  >
    <div class="button-export-container"><i-feather name="more-vertical" class="icon"></i-feather></div>
  </button>

  <app-tooltip-container
    *ngIf="isMobile && activeSystem!=OrderManagementIRPSystemId.OrderJourney && isActiveSystemIRP"
    [message]="toolTipMessage"
    [showToolTip]="!userPermission[userPermissions.CanCreateOrdersIRP]"
  >
    <button
      [disabled]="!canCreateOrderIRP || !userPermission[userPermissions.CanCreateOrdersIRP]"
      ejs-button
      appHideBeforeSyncfusionLoad
      [isPrimary]="true"
      (click)="navigateToOrderForm()"
    >
      Create Order
    </button>
  </app-tooltip-container>
  <app-tooltip-container
    *ngIf="isMobile && activeSystem!=OrderManagementIRPSystemId.OrderJourney && !isActiveSystemIRP"
    [message]="toolTipMessage"
    [showToolTip]="!userPermission[userPermissions.CanCreateOrders]"
  >
    <button
      [disabled]="!canCreateOrder || !userPermission[userPermissions.CanCreateOrders]"
      ejs-button
      appHideBeforeSyncfusionLoad
      [isPrimary]="true"
      (click)="navigateToOrderForm()"
    >
      Create Order
    </button>
  </app-tooltip-container>
</ng-template>

<ng-template #vmsGridTemplate>
  <ng-container *ngIf="activeSystem == OrderManagementIRPSystemId.VMS;else orderJourneyGridTemplate">
  <div class="mobile-group-button" [ngClass]="isIRPFlagEnabled ? 'irp' : 'vms'" *ngIf="isMobile">
    <ng-container [ngTemplateOutlet]="smallMenuButton"></ng-container>
  </div>
  <section class="grid-component">
    <ejs-grid
      #grid
      class="e-gridwithchildrow"
      (rowDataBound)="setRowHighlight($event)"
      [dataSource]="(ordersPage$ | async)?.items"
      [pageSettings]="pageSettings"
      [height]="isMobile ? mobileGridHeight : fullScreenGridHeight"
      [rowHeight]="rowHeight"
      [resizeSettings]="resizeSettings"
      [allowSorting]="allowSorting"
      [allowResizing]="allowResizing"
      [allowTextWrap]="allowWrap"
      (actionBegin)="actionBegin($event)"
      [selectionSettings]="selectionOptions"
      [textWrapSettings]="wrapSettings"
      [enableVirtualization]="false"
      (rowSelected)="onRowClick($event)"
      (rowDeselected)="onRowDeselect($event, gridWithChildRow)"
      (dataBound)="onDataBound()"
    >
      <e-columns>
        <e-column
          type="checkbox"
          [customAttributes]="{ class: 'bootstrap' }"
          width="50"
          [allowResizing]="false"
        ></e-column>
        <e-column headerTextAlign="Right" width="180" minWidth="140" maxWidth="220">
          <ng-template #headerTemplate let-data>
            <div class="controls-header" [class.hidden]="!isLoaded">
              <button
                ejs-button
                cssClass="e-flat icon-button"
                *ngIf="!isSubrowDisplay; else onSubrowToggle"
                (click)="expandAll()"
              >
                <span><img src="assets/icons/menu-expand.svg" alt="coll" class="icon" /></span>
              </button>
              <ng-template #onSubrowToggle>
                <button ejs-button cssClass="e-flat icon-button" (click)="collapseAll()">
                  <span><img src="assets/icons/menu-collapse.svg" alt="coll" class="icon c" /></span>
                </button>
              </ng-template>
              <button
                ejs-button
                cssClass="e-flat icon-button"
                *ngIf="isRowScaleUp; else onRowScaleDown"
                (click)="onRowScaleUpClick()"
              >
                <span><i-feather name="menu" class="icon"></i-feather></span>
              </button>
              <ng-template #onRowScaleDown>
                <button ejs-button cssClass="e-flat icon-button" (click)="onRowScaleDownClick()">
                  <span><i-feather name="align-justify" class="icon"></i-feather></span>
                </button>
              </ng-template>
            </div>
          </ng-template>
          <ng-template #template let-data>
            <div *ngIf="!data?.isTemplate; else templateButtons" [class.hidden]="!isLoaded" class="row-tool-buttons">
              <button
                ejs-button
                cssClass="default-icon-button e-flat e-primary with-badge"
              >
                <span><i-feather name="message-square" class="icon"></i-feather></span>
                <span *ngIf="data.unreadComments > 0" class="e-badge e-badge-success e-badge-pill right-overflow">{{
                  data.unreadComments
                }}</span>
              </button>
              <button
                ejs-button
                cssClass="default-icon-button e-flat e-primary with-badge"
                [disabled]="!data.documentsCount"
              >
                <span><i-feather name="paperclip" class="icon"></i-feather></span>
                <span *ngIf="data.documentsCount > 0" class="e-badge e-badge-success e-badge-pill right-overflow">
                  {{data.documentsCount}}
                </span>
              </button>
              <button
                ejs-button
                cssClass="e-flat secondary-icon-button"
                [class.green-background]="!data.isLocked"
                [disabled]="
                  !canCreateOrder || disabledLock(data.status) || data?.extensionFromId || !hasCreateEditOrderPermission
                "
                (click)="lockOrder(data); $event.stopPropagation()"
                *ngIf="isLockMenuButtonsShown"
              >
                <span *ngIf="data.isLocked"><i-feather name="lock" class="icon"></i-feather></span>
                <span *ngIf="!data.isLocked"
                  ><app-custom-icon name="unlock" class="icon supportive-green-10"></app-custom-icon
                ></span>
              </button>
              <button
                ejs-button
                [matMenuTriggerFor]="menu"
                (click)="$event.stopPropagation()"
                [disabled]="
                  (data.orderType === orderTypes.ReOrder && data.status === orderStatus.Closed) ||
                  !hasCreateEditOrderPermission
                "
                [matMenuTriggerData]="{
                  data: data,
                  items: data.menuItems
                }"
                cssClass="e-flat primary-icon-button"
              >
                <span><i-feather name="more-vertical" class="icon"></i-feather></span>
              </button>
            </div>
            <ng-template #templateButtons>
              <div class="row-tool-buttons" (click)="stopPropagation($event)">
                <i-feather
                  name="trash-2"
                  class="icon delete-template"
                  [class.disable]="!canCreateOrder || !hasCreateEditOrderPermission"
                  (click)="deleteOrder(data?.id)"
                ></i-feather>
              </div>
            </ng-template>
          </ng-template>
        </e-column>
        <e-column field="id" isPrimaryKey="true" width="140" minWidth="120" maxWidth="200">
          <ng-template #headerTemplate let-data>
            <span class="e-headertext">
              {{ activeTab !== OrganizationOrderManagementTabs.OrderTemplates ? 'ORDER ID' : 'TEMPLATE ID' }}
            </span>
          </ng-template>
          <ng-template #template let-data>
            <ng-container
              *ngIf="
                data.orderType === orderTypes.OpenPerDiem ? !data.reOrders?.length : !data.children?.length;
                else withToggle
              "
            >
              <div>
                <b>
                  <span> {{ data.organizationPrefix }}-{{ data.publicId }} </span>
                </b>
              </div>
            </ng-container>

            <ng-template #withToggle>
              <div class="subrow-toggle" (click)="onSubrowToggle($event, data)">
                <b>{{ data.organizationPrefix }}-{{ data.publicId }}</b
                ><i-feather [name]="subrowsState.has(+data.index) ? 'chevron-down' : 'chevron-right'"></i-feather>
              </div>
            </ng-template>
          </ng-template>
        </e-column>
        <e-column
          field="templateTitle"
          headerText="TEMPLATE TITLE"
          width="160"
          minWidth="140"
          maxWidth="200"
          textAlign="Left"
          [visible]="false"
        ></e-column>
        <e-column
          field="reOrderFromId"
          headerText="RE-ORDER ID"
          width="140"
          minWidth="120"
          maxWidth="200"
          [visible]="false"
        >
          <ng-template #template let-data>
            <ng-container *ngIf="!data.children?.length; else withToggle">
              <div>
                <b>{{ data.organizationPrefix }}-{{ data.publicId }}</b>
              </div>
            </ng-container>

            <ng-template #withToggle>
              <div class="subrow-toggle" (click)="onSubrowToggle($event, data)">
                <b>{{ data.organizationPrefix }}-{{ data.publicId }}</b>
                <i-feather [name]="subrowsState.has(+data.index) ? 'chevron-down' : 'chevron-right'"></i-feather>
              </div>
            </ng-template>
          </ng-template>
        </e-column>
        <e-column field="statusText" headerText="STATUS" width="215" minWidth="120" maxWidth="260">
          <ng-template #template let-data>
            <div class="status-cell" [class.ex-chip]="data?.extensionFromId">
              <ejs-chiplist>
                <e-chips>
                  <e-chip [text]="data.statusText" [cssClass]="data.statusText | chipsCssClass"></e-chip>
                  <e-chip *ngIf="data?.extensionFromId" text="E" cssClass="e-warning ex"></e-chip>
                </e-chips>
              </ejs-chiplist>
            </div>
          </ng-template>
        </e-column>
        <e-column field="orderType" headerText="TYPE" textAlign="Center" width="85" minWidth="70" maxWidth="110">
          <ng-template #template let-data>
            <div class="order-type-column" *ngIf="orderTypeTooltipMessage[data.orderType] as orderType">
              <ejs-tooltip id="tooltip" [content]="orderType" position="TopCenter">
                <span class="order-type-text-cell">{{ orderType[0] }}</span>
              </ejs-tooltip>
            </div>
          </ng-template>
        </e-column>
        <e-column field="jobTitle" headerText="JOB TITLE" width="115" minWidth="100" maxWidth="200"></e-column>
        <e-column
          field="skillName"
          headerText="SKILL"
          textAlign="Left"
          width="100"
          minWidth="90"
          maxWidth="200"
        ></e-column>
        <e-column
          field="openPositions"
          headerText="AVAIL POS."
          headerTextAlign="Right"
          width="135"
          minWidth="110"
          maxWidth="180"
        >
          <ng-template #template let-data>
            <ng-container *ngIf="data.orderType !== orderTypes.OpenPerDiem">
              <div class="align-right">{{ data.numberOfOpenPositions }}/{{ data.openPositions }}</div>
            </ng-container>
          </ng-template>
        </e-column>
        <e-column
          field="regionName"
          headerText="REGION"
          textAlign="Left"
          width="150"
          minWidth="90"
          maxWidth="200"
          [visible]="true"
        ></e-column>
        <e-column
          field="locationName"
          headerText="LOCATION"
          textAlign="Left"
          width="140"
          minWidth="110"
          maxWidth="200"
        ></e-column>
        <e-column
          field="departmentName"
          headerText="DEPARTMENT"
          textAlign="Left"
          width="140"
          minWidth="125"
          maxWidth="200"
        ></e-column>
        <e-column
          field="billRate"
          headerText="BILL RATE"
          headerTextAlign="Right"
          width="120"
          minWidth="100"
          maxWidth="200"
        >
          <ng-template #template let-data>
            <ng-container *ngIf="data.orderType !== orderTypes.PermPlacement">
              <div class="align-right">{{ data.billRate }}</div>
            </ng-container>
          </ng-template>
        </e-column>
        <e-column field="startDate" width="155" minWidth="135" maxWidth="200">
          <ng-template #headerTemplate let-data>
            <span class="e-headertext">
              {{ activeTab !== OrganizationOrderManagementTabs.ReOrders ? 'START DATE' : 'RE-ORDER DATE' }}
            </span>
          </ng-template>
          <ng-template #template let-data>
            <span>{{ data.startDate | date: 'MM/dd/yyy':'UTC' }}</span>
          </ng-template>
        </e-column>
        <e-column field="agencies" headerText="AGENCY" width="130" minWidth="95" maxWidth="200" [visible]="false">
          <ng-template #template let-data>
            <ng-container *ngIf="!data.agency?.length">
              <span>All</span>
            </ng-container>

            <ng-container *ngIf="data.agency?.length === 2 || data.agency?.length === 1">
              <span *ngFor="let agency of data.agency; let i = index" class="agency-name">
                {{ agency }}
                <span class="agency-name" *ngIf="i !== data.agency.length - 1">, </span>
              </span>
            </ng-container>

            <ng-container *ngIf="data.agency?.length >= 3 && data.agency?.length <= 5">
              <ejs-tooltip content="{{ data.agency.join(', ') }}" target="#agencyName">
                <span id="agencyName" class="agency-name">Multiple Agencies</span>
              </ejs-tooltip>
            </ng-container>

            <ng-container *ngIf="data.agency?.length > 5">
              <span id="agencyName" class="agency-name">Multiple Agencies</span>
            </ng-container>
          </ng-template>
        </e-column>
        <e-column
          field="shiftsNext90Days"
          headerText="# of Shifts Next 90 Days "
          textAlign="Right"
          headerTextAlign="Right"
          width="220"
          minWidth="200"
          maxWidth="260"
          [visible]="false"
        ></e-column>
        <e-column
          field="annualSalaryRangeFrom"
          headerText="Annual Salary From"
          textAlign="Right"
          headerTextAlign="Right"
          width="200"
          minWidth="180"
          maxWidth="260"
          [visible]="false"
        >
          <ng-template #template let-data>
            <span>{{ data.annualSalaryRangeFrom | currency: 'USD':'symbol':'1.0-2' }}</span>
          </ng-template>
        </e-column>
        <e-column
          field="annualSalaryRangeTo"
          headerText="Annual Salary To"
          textAlign="Right"
          headerTextAlign="Right"
          width="200"
          minWidth="160"
          maxWidth="260"
          [visible]="false"
        >
          <ng-template #template let-data>
            <span>{{ data.annualSalaryRangeTo | currency: 'USD':'symbol':'1.0-2' }}</span>
          </ng-template>
        </e-column>
        <e-column field="endDate" headerText="End Date" width="130" minWidth="105" maxWidth="200">
          <ng-template #template let-data>
            <span>{{ data.endDate | date: formatDate:'UTC' }}</span>
          </ng-template>
        </e-column>
        <e-column field="shiftName" headerText="Shift Name" width="160" minWidth="80" maxWidth="200">
          <ng-template #template let-data>
            <span>{{ data.shiftName }}</span>
          </ng-template>
        </e-column>
        <e-column field="shiftStartTime" headerText="Shift Start Time" width="160" minWidth="80" maxWidth="200">
          <ng-template #template let-data>
            <span>{{ data.shiftStartTime | date: 'HH:mm':'UTC' }}</span>
          </ng-template>
        </e-column>
        <e-column field="shiftEndTime" headerText="Shift End Time" width="160" minWidth="80" maxWidth="200">
          <ng-template #template let-data>
            <span>{{ data.shiftEndTime | date: 'HH:mm':'UTC' }}</span>
          </ng-template>
        </e-column>
        <e-column field="candidates" headerText="CAND." headerTextAlign="Right" width="90" minWidth="80" maxWidth="160">
          <ng-template #template let-data>
            <div class="align-right">{{ data.candidates }}</div>
          </ng-template>
        </e-column>
        <e-column field="creationDate" headerText="Creation Date" width="150" minWidth="140" maxWidth="200">
          <ng-template #template let-data>
            <span>{{ data.creationDate | date: formatDate }}</span>
          </ng-template>
        </e-column>
      </e-columns>

      <ng-template #detailTemplate let-data>
        <div class="subrow-wrapper">
          <ng-container *ngIf="data.orderType === orderTypes.OpenPerDiem; else defaultSubRow">
            <app-grid-subrow-reorder
              *ngFor="let child of data.reOrders"
              [reOrder]="child"
              [order]="data"
              [selected]="
                selectedReOrder?.selected?.order === data.id && selectedReOrder?.selected.reOrder === child.id
              "
              (clickEvent)="onOpenReorderDialog($event, data)"
            ></app-grid-subrow-reorder>
          </ng-container>
        </div>

        <ng-template #defaultSubRow>
          <ng-container *ngIf="data.isPushedFromIRP && isIRPFlagEnabled; else vmsSubRow">
            <app-order-management-subrow-candidate-position
              *ngFor="let child of data.children; index as i; trackBy: trackById"
              [candidatePosition]="child"
              [isBothSystemsEnabled]="isOrgIRPEnabled && isOrgVMSEnabled"
              [selected]="
                selectedCandidate?.selected?.order === data.id &&
                selectedCandidate?.selected.positionId === child.positionId"
                (openPosition)="onOpenCandidateDialog($event, data, i)"
            ></app-order-management-subrow-candidate-position>
          </ng-container>

          <ng-template #vmsSubRow>
            <app-grid-subrow-candidate
              *ngFor="let child of data.children; index as i"
              [candidat]="child"
              [order]="data"
              [selected]="
                selectedCandidate?.selected?.order === data.id &&
                selectedCandidate?.selected.positionId === child.positionId
              "
              [isAgency]="true"
              (clickEvent)="onOpenCandidateDialog($event, data, i)"
            ></app-grid-subrow-candidate>
          </ng-template>
        </ng-template>
      </ng-template>
    </ejs-grid>
  </section>
  </ng-container>
</ng-template>
<ng-template #orderJourneyGridTemplate>
  <section class="grid-component">
    <ejs-grid #grid [dataSource]="(ordersJourneyPage$ | async)?.items" class="e-gridwithchildrow" (rowDataBound)="setRowHighlight($event)"
      [pageSettings]="pageSettings" [height]="isMobile ? mobileGridHeight : fullScreenGridHeight"
      [rowHeight]="rowHeight" [resizeSettings]="resizeSettings" [allowSorting]="allowSorting"
      [allowResizing]="allowResizing" [allowTextWrap]="allowWrap" (actionBegin)="actionBegin($event)"
      [selectionSettings]="selectionOptions" [textWrapSettings]="wrapSettings" [enableVirtualization]="false"
      (rowSelected)="onOrderJourneyRowClick($event)"
      (rowDeselected)="onOrderJourneyRowDeselect($event,gridWithChildRow)"
      (dataBound)="onDataBound()">
      <e-columns>
        <e-column type="checkbox" [customAttributes]="{ class: 'bootstrap' }" width="50"
          [allowResizing]="false"></e-column>
        <e-column field="orderId" headerText="Order ID" width="140" minWidth="120" maxWidth="200"></e-column>
        <e-column field="status" headerText="Order Status" width="215" minWidth="120" maxWidth="260">
          <ng-template #template let-data>
            <div class="status-cell" [class.ex-chip]="data?.status">
              <ejs-chiplist>
                <e-chips>
                  <e-chip [text]="data.status" [cssClass]="data.status | chipsCssClass"></e-chip>
                </e-chips>
              </ejs-chiplist>
            </div>
          </ng-template>
        </e-column>
        <e-column field="system" headerText="System" width=250>
          <ng-template #template let-data>
            <ng-container *ngIf="data.system != 'IRP, VMS'; else bothSystem">
              <div class="subrow-toggle" (click)="onClickSystem(data.system)">
                <b>{{data.system}}</b>
                </div>
            </ng-container>
            <ng-template #bothSystem >
              <div class="subrow-toggle">
                <b (click)="onClickSystem('IRP')">IRP,</b>&nbsp;<b (click)="onClickSystem('VMS')">VMS</b>
              </div>
            </ng-template>

          </ng-template>

        </e-column>
        <e-column field="type" headerText="Type" textAlign="Center" width="85" minWidth="70" maxWidth="110">
        </e-column>
        <e-column field="jobTitle" headerText="Job Title" width="115" minWidth="100" maxWidth="200">
        </e-column>
        <e-column field="skill" headerText="Skill" textAlign="Left" width="100" minWidth="90" maxWidth="200">
        </e-column>
        <e-column field="creationDate" headerText="Creation Date" width="155" minWidth="135" maxWidth="200">
          <ng-template #template let-data>
            {{ data.creationDate | date: "MM/dd/yyyy" }}
          </ng-template>
        </e-column>
        <e-column field="publishedInIRP" headerText="Published In IRP" width=150>
          <ng-template #template let-data>
            <ng-container *ngIf="data.publishedInIRP !=null">
              <div >{{data.publishedInIRP | date: "MM/dd/yyyy" }}</div>
            </ng-container>
          </ng-template>
        </e-column>
        <e-column field="noOfDaysInIRP" headerText="#Of Days In IRP" width=150>
        </e-column>
        <e-column field="publishedInVMS" headerText="Published In VMS" width=150>
          <ng-template #template let-data>
            <ng-container *ngIf="data.publishedInVMS !=null">
              <div >{{data.publishedInVMS | date: "MM/dd/yyyy" }}</div>
            </ng-container>
          </ng-template>
        </e-column>
        <e-column field="noOfDaysInVMS" headerText="#Of Days In VMS" width=150>
        </e-column>
      </e-columns>


    </ejs-grid>
  </section>
</ng-template>


<app-export-dialog
  [columns]="columnsToExport"
  [fileName]="fileName"
  (cancel)="closeExport()"
  (export)="export($event)"
></app-export-dialog>

<app-filter-dialog
  *ngIf="activeTab !== OrganizationOrderManagementTabs.OrderTemplates && activeSystem != OrderManagementIRPSystemId.OrderJourney"
  [items]="filteredItems"
  [count]="(ordersPage$ | async)?.totalCount"
  [targetElement]="targetElement"
  (deleteFilter)="onFilterDelete($event)"
  (clearAllFiltersClicked)="onFilterClearAll()"
  (applyFilterClicked)="onFilterApply()"
  (closeDialogClicked)="onFilterClose()"
>
  <form [formGroup]="OrderFilterFormGroup" *ngIf="showFilterForm">
    <div class="bootstrap">
      <div class="input-container">
        <label for="orderId">{{
          activeTab === OrganizationOrderManagementTabs.ReOrders ? 'Re-Order ID' : 'Order ID'
        }}</label>
        <div class="input-group">
          <input id="orderId" class="e-input" type="text" maxlength="50" formControlName="orderPublicId" />
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Region</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="regionIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.regionIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Location</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="locationIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [filterType]="filterType"
            [dataSource]="filterColumns.locationIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Department</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="departmentsIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [filterType]="filterType"
            [dataSource]="filterColumns.departmentsIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Skill</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="skillIds"
            placeholder="All"
            [fields]="skillsFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.skillIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap" *ngIf="!isActiveSystemIRP">
      <div class="input-container">
        <label>Select Agency</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="agencyIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.agencyIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap">
      <div
        class="input-container"
        *ngIf="
          (!isActiveSystemIRP && activeTab !== OrganizationOrderManagementTabs.ReOrders &&
          activeTab !== OrganizationOrderManagementTabs.PerDiem &&
          activeTab !== OrganizationOrderManagementTabs.PermPlacement) ||
          (isActiveSystemIRP && activeIRPTabIndex === OrderManagementIRPTabsIndex.AllOrders)
        "
      >
        <label>Order Type</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="orderTypes"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.orderTypes.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
      <div class="input-container"
           *ngIf="!isActiveSystemIRP || (isActiveSystemIRP && activeIRPTabIndex !== OrderManagementIRPTabsIndex.Incomplete)">
        <label>Order Status</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            #orderStatusFilter
            mode="CheckBox"
            formControlName="orderStatuses"
            placeholder="All"
            [fields]="statusFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.orderStatuses.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
            (select)="onSelect($event)"
            cssClass="custom"
            (click)="orderStatusSelect()"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap"
    *ngIf="!isActiveSystemIRP && activeTab === OrganizationOrderManagementTabs.PerDiem">
      <div
        class="input-container">
        <div class="input-group multiselect">
          <label>Re-Order Status</label>
          <ejs-multiselect
            #orderStatusFilter
            mode="CheckBox"
            formControlName="reorderStatuses"
            placeholder="All"
            [fields]="statusFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.reorderStatuses.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap"
         *ngIf="!isActiveSystemIRP || (isActiveSystemIRP && activeIRPTabIndex !== OrderManagementIRPTabsIndex.Incomplete)">
      <div class="input-container">
        <label *ngIf="activeSystem === OrderManagementIRPSystemId.IRP">Employee Name</label>
        <label *ngIf="activeSystem === OrderManagementIRPSystemId.VMS">Candidate Name</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="candidateName" />
        </div>
      </div>
      <div class="input-container"
           *ngIf="!isActiveSystemIRP">
          <label *ngIf="activeSystem === OrderManagementIRPSystemId.IRP">Employee Status</label>
          <label *ngIf="activeSystem === OrderManagementIRPSystemId.VMS">Candidate Status</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="candidateStatuses"
            placeholder="All"
            [fields]="filterStatusFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.candidateStatuses.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap">
      <div class="input-container" *ngIf="activeTab == 'Perm Placement' || activeTab == 'All Orders' || activeTab == 'Per Diem'">
        <label>Order Lock</label>
        <div class="input-group dropdown">
          <ejs-dropdownlist  formControlName="orderLocked" [fields]="optionFields"
              placeholder="All" [allowFiltering]="true" [dataSource]="orderLockList">
          </ejs-dropdownlist>
        </div>
      </div>
      <div class="input-container">
        <label>Contact Person</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="contactEmails" />
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Special Project Category</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            placeholder="All"
            formControlName="projectTypeIds"
            [allowFiltering]="true"
            [dataSource]="filterColumns.projectTypeIds.dataSource"
            [fields]="specialProjectCategoriesFields"
            [showDropDownIcon]="true"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="row bootstrap">
      <div class="input-container">
        <label>Project Name</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            placeholder="All"
            formControlName="projectNameIds"
            [allowFiltering]="true"
            [dataSource]="filterColumns.projectNameIds.dataSource"
            [fields]="projectNameFields"
            [showDropDownIcon]="true"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
      <div class="input-container" *ngIf="isActiveSystemIRP">
        <label>Shift Name</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            placeholder="All"
            formControlName="shiftIds"
            [allowFiltering]="true"
            [dataSource]="filterColumns.shiftIds.dataSource"
            [fields]="shiftNameFields"
            [showDropDownIcon]="true"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
      <div class="input-container" *ngIf="!isActiveSystemIRP">
        <label>PO #</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            placeholder="All"
            formControlName="poNumberIds"
            [allowFiltering]="true"
            [dataSource]="filterColumns.poNumberIds.dataSource"
            [fields]="poNumberFields"
            [showDropDownIcon]="true"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap" *ngIf="!isActiveSystemIRP">
      <div class="input-container">
      <label>Job Title</label>
      <div class="input-group">
      <input class="e-input" type="text" maxlength="50" formControlName="jobTitle" />
      </div>
      </div>
      <div class="input-container">
      <label>Shift Name</label>
      <div class="input-group multiselect">
      <ejs-multiselect
                  mode="CheckBox"
                  [allowFiltering]="true"
                  [dataSource]="filterColumns.shift.dataSource"
                  [fields]="shiftFields"
                  [showDropDownIcon]="true"
                  [changeOnBlur]="!(isMobile || isTablet)"
                  formControlName="shift"
      >
      </ejs-multiselect>
      </div>
      </div>
      </div>
    <div
      class="filter-row bootstrap"
      *ngIf="
        activeTab !== OrganizationOrderManagementTabs.PerDiem &&
        activeTab !== OrganizationOrderManagementTabs.PermPlacement &&
        !isActiveSystemIRP
      "
    >
      <div class="input-container">
        <label>Bill Rate From</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="billRateFrom" />
        </div>
      </div>
      <div class="input-container">
        <label>Bill Rate To</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="billRateTo" />
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap"
    *ngIf="(activeTab !== OrganizationOrderManagementTabs.PerDiem && !isActiveSystemIRP) || (isActiveSystemIRP && activeIRPTabIndex !== OrderManagementIRPTabsIndex.Incomplete)">
      <div class="input-container">
        <label *ngIf="activeSystem === OrderManagementIRPSystemId.IRP">Employee Count From</label>
        <label *ngIf="activeSystem === OrderManagementIRPSystemId.VMS">Candidate Count From</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="candidatesCountFrom" />
        </div>
      </div>
      <div class="input-container">
        <label *ngIf="activeSystem === OrderManagementIRPSystemId.IRP">Employee Count To</label>
        <label *ngIf="activeSystem === OrderManagementIRPSystemId.VMS">Candidate Count To</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="candidatesCountTo" />
        </div>
      </div>
      <div class="input-container number-of-positions">
        <label for="numberOfPositions"># of Positions</label>
        <div class="input-group">
          <input id="numberOfPositions" class="e-input" type="text" maxlength="50" formControlName="openPositions" />
        </div>
      </div>
    </div>
    <div *ngIf="activeTab === OrganizationOrderManagementTabs.PermPlacement && !isActiveSystemIRP" class="filter-row bootstrap">
      <div class="input-container">
        <label>Annual Salary From</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="annualSalaryRangeFrom" />
        </div>
      </div>
      <div class="input-container">
        <label>Annual Salary To</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="annualSalaryRangeTo" />
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap" *ngIf="activeTab !== OrganizationOrderManagementTabs.PerDiem">
      <div class="input-container calendar">
        <label for="jobStartDate">{{
          activeTab !== OrganizationOrderManagementTabs.ReOrders ? 'Job Start Date' : 'Re-Order Date'
        }}</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            id="jobStartDate"
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="jobStartDate"
          >
          </ejs-datepicker>
        </div>
      </div>
      <div
        class="input-container calendar"
        *ngIf="
          activeTab !== OrganizationOrderManagementTabs.ReOrders &&
          activeTab !== OrganizationOrderManagementTabs.PermPlacement
        "
      >
        <label for="jobEndDate">Job End Date</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            id="jobEndDate"
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="jobEndDate"
          >
          </ejs-datepicker>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap">
      <div class="input-container calendar">
        <label>Creation Date From</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="creationDateFrom"
          >
          </ejs-datepicker>
        </div>
      </div>
      <div class="input-container calendar">
        <label>Creation Date To</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="creationDateTo"
          >
          </ejs-datepicker>
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap">
      <div class="input-container calendar">
        <label>Distributed On From</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="distributedOnFrom"
          >
          </ejs-datepicker>
        </div>
      </div>
      <div class="input-container calendar">
        <label>Distributed On To</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="distributedOnTo"
          >
          </ejs-datepicker>
        </div>
      </div>
    </div>
    <div *ngIf="!isActiveSystemIRP">
      <div class="radio-container">
        <label class="radio-label">Internal Agency</label>
        <ejs-radiobutton formControlName="agencyType" label="Yes" name="agencyType" value="1"></ejs-radiobutton>
        <ejs-radiobutton formControlName="agencyType" label="No" name="agencyType" value="2"></ejs-radiobutton>
        <ejs-radiobutton formControlName="agencyType" label="Both" name="agencyType" value="0"></ejs-radiobutton>
      </div>
    </div>
    <div *ngIf="isActiveSystemIRP">
      <ejs-switch class="toggle"
        formControlName="irpOnly"
      ></ejs-switch>
      <span>IRP Only</span>
    </div>
  </form>
</app-filter-dialog>

<app-filter-dialog
  *ngIf="activeSystem == OrderManagementIRPSystemId.OrderJourney"
  [items]="filteredOrdersJourneyItems"
  [count]="(ordersJourneyPage$ | async)?.totalCount"
  [targetElement]="targetElement"
  (deleteFilter)="onOrderJourneyFilterDelete($event)"
  (clearAllFiltersClicked)="onOrderJourneyFilterClearAll()"
  (applyFilterClicked)="onOrderJourneyFilterApply()"
  (closeDialogClicked)="onOrderJourneyFilterClose()"
>
  <form [formGroup]="OrderJourneyFilterFormGroup" *ngIf="showFilterForm">
<div class="bootstrap">
  <div class="input-container">
    <label>Select System <span class="required">*</span></label>
    <div class="bootstrap checkbox-container">
      <ejs-checkbox formControlName="includeInIRP" label="IRP"></ejs-checkbox>
      <ejs-checkbox formControlName="includeInVMS" label="VMS"></ejs-checkbox>
    </div>
  </div>
</div>

    <div class="bootstrap">
      <div class="input-container">
        <label for="orderId">Order ID</label>
        <div class="input-group">
          <input id="orderId" class="e-input" type="text" maxlength="50" formControlName="orderPublicId" />
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Region</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="regionIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterOrderJourneyColumns.regionIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Location</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="locationIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [filterType]="filterType"
            [dataSource]="filterOrderJourneyColumns.locationIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Department</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="departmentsIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [filterType]="filterType"
            [dataSource]="filterOrderJourneyColumns.departmentsIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Skill</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="skillIds"
            placeholder="All"
            [fields]="skillsFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterOrderJourneyColumns.skillIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>

    <div class="filter-row bootstrap">
      <div
        class="input-container"
        *ngIf="
          (!isActiveSystemIRP && activeTab !== OrganizationOrderManagementTabs.ReOrders &&
          activeTab !== OrganizationOrderManagementTabs.PerDiem &&
          activeTab !== OrganizationOrderManagementTabs.PermPlacement) ||
          (isActiveSystemIRP && activeIRPTabIndex === OrderManagementIRPTabsIndex.AllOrders)">
        <label>Order Type</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="orderTypes"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterOrderJourneyColumns.orderTypes.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
      <div class="input-container"
           *ngIf="!isActiveSystemIRP || (isActiveSystemIRP && activeIRPTabIndex !== OrderManagementIRPTabsIndex.Incomplete)">
        <label>Order Status</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            #orderStatusFilter
            mode="CheckBox"
            formControlName="orderStatuses"
            placeholder="All"
            [fields]="statusFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterOrderJourneyColumns.orderStatuses.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)">
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap" *ngIf="!isActiveSystemIRP">
      <div class="input-container">
        <label>Job Title</label>
        <div class="input-group">
          <input class="e-input" type="text" maxlength="50" formControlName="jobTitle" />
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap">
      <div class="input-container calendar">
        <label for="jobStartDate">
         Job Start Date
        </label>
        <div class="input-group datepicker">
          <ejs-datepicker
            id="jobStartDate"
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="jobStartDate">
          </ejs-datepicker>
        </div>
      </div>
      <div class="input-container calendar">
        <label for="jobEndDate">Job End Date</label>
        <div class="input-group datepicker">
          <ejs-datepicker
            id="jobEndDate"
            class="datepicker"
            [format]="formatDate"
            [placeholder]="placeholderDate"
            [enableMask]="true"
            [maskPlaceholder]="datepickerMask"
            formControlName="jobEndDate"
          >
          </ejs-datepicker>
        </div>
      </div>
    </div>
  </form>
</app-filter-dialog>
<app-filter-dialog
  *ngIf="activeTab === OrganizationOrderManagementTabs.OrderTemplates"
  [items]="filteredItems"
  [count]="(ordersPage$ | async)?.totalCount"
  (deleteFilter)="onFilterDelete($event)"
  (clearAllFiltersClicked)="onFilterClearAll()"
  (applyFilterClicked)="onFilterApply()"
  (closeDialogClicked)="onFilterClose()"
>
  <form [formGroup]="OrderFilterFormGroup">
    <div class="bootstrap">
      <div class="input-container">
        <label for="templateId">Template ID</label>
        <div class="input-group">
          <input id="templateId" class="e-input" type="text" maxlength="50" formControlName="orderPublicId" />
        </div>
      </div>
    </div>
    <div class="filter-row bootstrap">
      <div class="input-container">
        <label>Region</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="regionIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.regionIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
      <div class="input-container">
        <label>Location</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="locationIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [filterType]="filterType"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.locationIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Department</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="departmentsIds"
            placeholder="All"
            [fields]="optionFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [filterType]="filterType"
            [dataSource]="filterColumns.departmentsIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
      <div class="input-container">
        <label>Skill</label>
        <div class="input-group multiselect">
          <ejs-multiselect
            mode="CheckBox"
            formControlName="skillIds"
            placeholder="All"
            [fields]="skillsFields"
            [allowFiltering]="true"
            [showDropDownIcon]="true"
            [dataSource]="filterColumns.skillIds.dataSource"
            [changeOnBlur]="!(isMobile || isTablet)"
          >
          </ejs-multiselect>
        </div>
      </div>
    </div>
    <div class="bootstrap">
    <div class="input-container">
      <label>Shift Name</label>
      <div class="input-group multiselect">
        <ejs-multiselect
          mode="CheckBox"
          placeholder="All"
          formControlName="shiftIds"
          [allowFiltering]="true"
          [dataSource]="filterColumns.shift.dataSource"
          [fields]="shiftNameFields"
          [showDropDownIcon]="true"
          [changeOnBlur]="!(isMobile || isTablet)"
        >
        </ejs-multiselect>
      </div>
    </div>
  </div>
  </form>
</app-filter-dialog>

<app-order-details-dialog
  #detailsDialog
  [order]="selectedOrder"
  [activeIRPtabs]="activeIRPTabIndex"
  [children]="selectedDataRow?.children"
  [settings]="settings"
  [openEvent]="openDetails"
  [isCondidateTab]="isCondidateTab"
  [activeSystem]="activeSystem"
  [orderPositionSelected$]="orderPositionSelected$"
  [hasCreateEditOrderPermission]="hasCreateEditOrderPermission"
  [hasCanEditOrderBillRatePermission]="userPermission[userPermissions.CanEditOrderBillRate]"
  [CanEditOrderBillRateIRP]="userPermission[userPermissions.CanEditOrderBillRateIRP]"
  [CanCloseOrdersIRP] = "userPermission[userPermissions.CanCloseOrdersIRP]"
  [CanOrganizationEditOrdersIRP]="userPermission[userPermissions.CanCreateOrdersIRP]"
  [CanOrganizationViewOrdersIRP]="userPermission[userPermissions.CanOrganizationViewOrdersIRP]"
  (selectReOrder)="selectReOrder($event)"
  (saveReOrderEmitter)="updateGrid(true)"
  (closeReOrderEmitter)="onAddReorderClose()"
  (nextPreviousOrderEvent)="onNextPreviousOrderEvent($event)"
  (updateOrders)="getOrders(true)"
  (reOpenOrderSuccess)="updateOrderDetails($event)"
  [orderComments]="orderComments"
  (editOrderPressed)="preserveOrder($event)"
></app-order-details-dialog>

<app-update-reg-rate
  #updaterateRow
  *ngIf="userPermission[userPermissions.CanBulkHourlyRateUpdate] && openregrateupdate"
  [orderdatas]="CurrentOrderDatas"
  [perdiemOrderData]="PerDiemOrderDatas"
  (reloadItemsListforupdate)="updatePageforbulk()"
></app-update-reg-rate>

<app-child-order-dialog
  [order]="$any(selectedOrder)"
  [orderComments]="orderComments"
  [candidate]="selectedCandidate"
  [openEvent]="openChildDialog"
  [activeSystem]="activeSystem"
  [filters]="filters"
  (saveEmitter)="updateGrid()"
  (reOpenPositionSuccess)="updatePositionDetails($event)"
></app-child-order-dialog>

<app-close-order
  [order]="selectedOrder"
  [currentSystem]="activeSystem"
  [candidate]="selectedCandidate"
  (closeOrderSuccess)="updateOrderDetails($event)"
  (closePositionSuccess)="updatePositionDetails($event)"
>
</app-close-order>

<mat-menu #menu="matMenu">
  <ng-template matMenuContent let-items="items" let-data="data">
    <button
      mat-menu-item
      *ngFor="let item of items"
      [disabled]="item.disabled"
      (click)="menuOptionSelected(item.id, data)"
    >
      {{ item.text }}
    </button>
  </ng-template>
</mat-menu>

<app-order-import [dialogEvent]="importDialogEvent" (reloadItemsList)="updatePage()"></app-order-import>

<app-scroll-to-top *ngIf="isMobile"></app-scroll-to-top>
