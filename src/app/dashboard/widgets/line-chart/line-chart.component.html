<app-widget-wrapper [isLoading]="isLoading">
  <ng-template #header>
    <div class="widget-header">
      <h3 class="widget-header__title">{{ 'Positions Trend' }}</h3>
      <div class="widget-header__actions">
        <button
          ejs-button
          [isPrimary]="monthMode"
          [cssClass]="monthMode ? 'e-small' : 'e-outline e-small'"
          (click)="onSwicthTo(monthlySelection)"
        >
          Monthly
        </button>
        <button
          ejs-button
          [isPrimary]="!monthMode"
          [cssClass]="!monthMode ? 'e-small' : 'e-outline e-small'"
          (click)="onSwicthTo(weeklySelection)"
        >
          Weekly
        </button>
      </div>
    </div>
  </ng-template>
  <ng-template #lineChart>
    <ejs-chart
      #sfComponent
      [chartArea]="chartArea"
      [primaryXAxis]="primaryXAxis"
      [primaryYAxis]="primaryYAxis"
      [crosshair]="crosshairSettings"
      [legendSettings]="legendSettings"
      [tooltip]="tooltipSettings"
      class="app-line-chart__component"
      [palettes]="palettes"
    >
      <e-series-collection>
        <!-- ngFor structural directive can't be used due to an error in Syncfusion library v.20.1.57 during rendering -->
        <e-series
          [dataSource]="(filteredChartData$ | async)?.[positionTypeEnum.OPEN] ?? []"
          [name]="positionTypeEnum.OPEN"
          [width]="lineWidthInPixels"
          [xName]="xAxisName"
          [yName]="yAxisName"
          [legendShape]="legendShape"
          [type]="type"
        ></e-series>
        <e-series
          [dataSource]="(filteredChartData$ | async)?.[positionTypeEnum.ONBOARD] ?? []"
          [name]="positionTypeEnum.ONBOARD"
          [width]="lineWidthInPixels"
          [xName]="xAxisName"
          [yName]="yAxisName"
          [legendShape]="legendShape"
          [type]="type"
        ></e-series>
        <e-series
          [dataSource]="(filteredChartData$ | async)?.[positionTypeEnum.CLOSED] ?? []"
          [name]="positionTypeEnum.CLOSED"
          [width]="lineWidthInPixels"
          [xName]="xAxisName"
          [yName]="yAxisName"
          [legendShape]="legendShape"
          [type]="type"
        ></e-series>
        <e-series
          [dataSource]="(filteredChartData$ | async)?.[positionTypeEnum.IN_PROGRESS] ?? []"
          [name]="positionTypeEnum.IN_PROGRESS"
          [width]="lineWidthInPixels"
          [xName]="xAxisName"
          [yName]="yAxisName"
          [legendShape]="legendShape"
          [type]="type"
        ></e-series>
      </e-series-collection>
    </ejs-chart>
  </ng-template>

  <ng-template #legend>
    <app-widget-legend
      [legendData]="chartLegend"
      (changeCheckbox)="onClickLegend($event)"
      (onClickLegend)="redirectToSourceContent()"
      [showPercentRatio]="true"
    ></app-widget-legend>
  </ng-template>
</app-widget-wrapper>
