<div class="schedule-items-container">
  <div *ngIf="!scheduleItems.length" class="empty-list-text">At least one Candidate and date is required to Schedule a shift</div>
  <div class="schedule-items-header" *ngIf="!selectedType">
    <div class="header-itm">Candidates Selected <span class="header-itm__count">{{scheduleItems?.length}}</span></div>
    <div class="group-error" *ngIf="itemsErrorCounter">
      <div class="header-itm">
        Errors
        <span class="header-itm__errors">{{itemsErrorCounter}}</span>
      </div>
      <div class="error-message">Remove or correct invalid records to save</div>
    </div>
  </div>
  <div class="schedule-item" *ngFor="let item of scheduleItems; trackBy: trackByCandidateId">
    <button ejs-button cssClass="e-flat" (click)="removeScheduleItem(item.candidateId)">
      <i-feather name="x" class="icon"></i-feather>
    </button>
    <ng-container *ngIf="!item.tooltipContent; else candidateTooltip">
      <span class="candidate-name">{{item.candidateName}}</span>
    </ng-container>

    <ng-template #candidateTooltip>
      <ejs-tooltip [showTipPointer]="false" [content]="item.tooltipContent" position="TopCenter">
        <span class="candidate-name" [class.candidate-name-error]="item.hasError">{{item.candidateName}}</span>
      </ejs-tooltip>
    </ng-template>

    <app-icon-multi-date-picker
      [datePickerLimitations]="datePickerLimitations"
      [dates]="item.selectedDates"
      (appliedDates)="updateDateItems($event, item.candidateId)"
    ></app-icon-multi-date-picker>

    <ng-container *ngFor="let dateItem of item.dateItems; trackBy: trackByDate">
      <ng-container *ngIf="dateItem.tooltipContent">
        <ejs-tooltip [showTipPointer]="false" [content]="dateItem.tooltipContent" position="TopCenter">
          <ng-container
            [ngTemplateOutlet]="dateTemplate"
            [ngTemplateOutletContext]="{ item, dateItem }"
          ></ng-container>
        </ejs-tooltip>
      </ng-container>
      <ng-container *ngIf="!dateItem.tooltipContent">
        <ng-container
          [ngTemplateOutlet]="dateTemplate"
          [ngTemplateOutletContext]="{ item, dateItem }"
        ></ng-container>
      </ng-container>
    </ng-container>

  </div>
</div>

<ng-template #dateTemplate let-dateItem="dateItem" let-item="item">
  <div class="date" [class.date-errors]="dateItem.hasError">
    <i-feather *ngIf="dateItem.scheduleType === scheduleType.Availability" name="clock" class="icon"></i-feather>
    <i-feather *ngIf="dateItem.scheduleType === scheduleType.Unavailability" name="alert-triangle" class="icon"></i-feather>
    <i-feather *ngIf="dateItem.scheduleType === scheduleType.Book" name="briefcase" class="icon"></i-feather>
    <span>{{dateItem.date | date: "MM/dd/yyyy"}}
      <span class="schedule-type" *ngIf="dateItem.scheduleType === scheduleType.Book">L</span>
    </span>
    <button ejs-button cssClass="e-flat" (click)="removeDateItem(item.candidateId, dateItem.dateValue, dateItem.id)">
      <i-feather name="x" class="icon"></i-feather>
    </button>
  </div>
</ng-template>
