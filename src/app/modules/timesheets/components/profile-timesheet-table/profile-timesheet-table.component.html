<section class="table-container">
  <div class="table-block">
    <div class="table-header">
      <div [ngClass]="{ 'first-tab': isFirstSelected }" class="tab-wrapper">
        <ejs-tab id="tab_default" #tabs (selected)="onTabSelect($event)">
          <e-tabitems>
            <e-tabitem *ngFor="let tab of tabsConfig; trackBy: trackByIndex">
              <ng-template #headerText>
                <div>{{ tab.title }}</div>
              </ng-template>
              <ng-template #content> </ng-template>
            </e-tabitem>
          </e-tabitems>
        </ejs-tab>
      </div>

      <div class="action-buttons">
        <ng-container *ngIf="isEditEnabled">
          <app-tooltip-container [showToolTip]="!hasPermissions" *ngIf="!actionsDisabled && (currentTab !== tableTypes.Expenses)">
            <button
              class="add-action spaced"
              cssClass="e-action-button"
              ejs-button
              [disabled]="disableAnyAction || !hasPermissions"
              (click)="openAddDialog()"
            >
              <i-feather name="plus" class="icon"></i-feather> <span class="action-text">Add Record</span>
            </button>
          </app-tooltip-container>

          <ng-container *ngIf="!actionsDisabled && (recordsToShow?.[currentTab]?.[modeValues.Edit]?.length || isEditOn)">
            <app-tooltip-container [showToolTip]="!hasPermissions" *ngIf="!isEditOn; else editHandlers">
              <button
                (click)="editTimesheets()"
                [disabled]="disableAnyAction || !hasPermissions"
                ejs-button
                cssClass="e-action-button"
                class="add-action">
                <i-feather name="edit" class="icon"></i-feather>
                <span class="action-text">Edit</span>
              </button>
            </app-tooltip-container>
          </ng-container>
        </ng-container>

        <ng-template #editHandlers>
          <div class="controls-wrapper">
            <button ejs-button cssClass="e-outline button-cancel" (click)="cancelChanges()">Cancel</button>
            <button (click)="saveChanges()" ejs-button [isPrimary]="true" class="spinner-btn">
              <div #spinner class="spinner-container" *ngIf="loading; else savetext"></div>
              <ng-template #savetext>
                <span>Save</span>
              </ng-template>
            </button>
          </div>
        </ng-template>

        <div class="desktop-tablet-btn-group">
          <ng-container *ngTemplateOutlet="btnGroup"></ng-container>
        </div>
      </div>
    </div>

    <div class="grid-table-container">
      <ag-grid-angular
        #grid
        *ngIf="recordsToShow"
        [columnDefs]="timesheetColDef"
        [rowData]="recordsToShow[currentTab][currentMode]"
        [context]="context"
        [rowHeight]="64"
        [modules]="modules"
        [pagination]="false"
        [getRowStyle]="getRowStyle"
        [class.empty-table]="!recordsToShow[currentTab][currentMode].length"
        [overlayNoRowsTemplate]="gridEmptyMessage"
        (gridReady)="onGridReady($event)"
        (componentStateChanged)="onComponentStateChanged($event)"
        class="ag-theme-alpine app-grid__component"
      >
      </ag-grid-angular>
    </div>
    <div class="mobile-btn-group">
      <ng-container *ngTemplateOutlet="btnGroup"></ng-container>
    </div>
  </div>
</section>

<ng-template #btnGroup>
  <div class="btn-group" *ngIf="currentTab !== tableTypes.Expenses && !isEditOn">
    <app-tooltip-container [showToolTip]="!hasPermissions" *ngIf="isRejectBtnEnabled && !actionsDisabled">
      <button
        ejs-button
        [disabled]="disableAnyAction || actionButtonDisabled || !hasPermissions"
        cssClass="e-outline privilege"
        (click)="onRejectButtonClick()"
      >
        Reject
      </button>
    </app-tooltip-container>
    <app-tooltip-container [showToolTip]="!hasPermissions" *ngIf="isApproveBtnEnabled">
      <button
        ejs-button
        [isPrimary]="true"
        [disabled]="disableAnyAction || actionButtonDisabled || !hasPermissions"
        cssClass="spinner-btn privilege"
        (click)="handleApprove()"
      >
        <div #spinner class="spinner-container" *ngIf="loading; else approvetext"></div>
        <ng-template #approvetext>
          <span>{{ submitText }}</span>
        </ng-template>
      </button>
    </app-tooltip-container>
    <app-tooltip-container [showToolTip]="!hasPermissions" *ngIf="!isApproveBtnEnabled && isOrgSubmitBtnEnabled">
      <button
        ejs-button
        [isPrimary]="true"
        [disabled]="disableAnyAction || actionButtonDisabled || !hasPermissions"
        cssClass="spinner-btn privilege"
        (click)="orgSubmit()"
      >
        <div #spinner class="spinner-container" *ngIf="loading; else submittext"></div>
        <ng-template #submittext>
          <span>Submit</span>
        </ng-template>
      </button>
    </app-tooltip-container>
  </div>
</ng-template>
