<app-page-toolbar>
  <ng-container left>
    <app-tab-dynamic-navigation
      [tabConfig]="tabConfig"
      (changeTab)="handleChangeTab($event)">
    </app-tab-dynamic-navigation>
  </ng-container>
  <ng-container right>
    <app-search class="search"></app-search>
    <app-date-week-picker
      [dateControl]="formGroup.get('date') | controlConverter">
    </app-date-week-picker>
    <button
      ejs-button
      cssClass="e-outline button-filter button--no-wrap"
      (click)="showFilters()">
      Filters <i-feather name="sliders" class="icon"></i-feather>
    </button>
    <button
      ejs-dropdownbutton
      [items]="exportOptions"
      (select)="exportSelected($event)"
      id="importButton"
      cssClass="e-outline button-export button--no-wrap">
      Export <i-feather name="download" class="icon"></i-feather>
    </button>
  </ng-container>
</app-page-toolbar>

<section>
  <app-timesheets-table
    *ngIf="timesheets$ | async as timesheets"
    [tableData]="timesheets"
    [changeTableItem]="currentSelectedTableRowIndex | async"
    (changePage)="handleChangePage($event)"
    (changePerPage)="handleChangePerPage($event)"
    (timesheetRowSelected)="rowSelected($event)"
  >
  </app-timesheets-table>
</section>

<app-filter-dialog
  [items]="filteredItems"
  [count]="(timesheets$ | async)?.totalCount"
  (deleteFilter)="onFilterDelete($event)"
  (clearAllFiltersClicked)="onFilterClearAll()"
  (applyFilterClicked)="onFilterApply()">
  <form class="bootstrap" [formGroup]="formGroup">
    <div class="input-container">
      <label for="orderId">Order ID</label>
      <input
        id="orderId"
        class="e-input"
        type="text"
        appValidateWithMessage
        formControlName="orderId"
        maxlength="50"
        placeholder="" />
    </div>
    <div class="input-container">
      <label for="status">Status</label>
      <div class="input-group dropdown">
        <ejs-multiselect
          id="status"
          mode="CheckBox"
          [fields]="filterOptionFields"
          [dataSource]="filterColumns.statusText?.dataSource"
          [showDropDownIcon]="true"
          formControlName="status"
          placeholder=""></ejs-multiselect>
      </div>
    </div>
    <div class="input-container">
      <label for="department">Department</label>
      <div class="input-group dropdown">
        <ejs-multiselect
          id="department"
          mode="CheckBox"
          [fields]="filterOptionFields"
          [dataSource]="filterColumns.departmentName?.dataSource"
          [showDropDownIcon]="true"
          formControlName="department"
          placeholder=""></ejs-multiselect>
      </div>
    </div>
    <div class="input-container">
      <label for="agencyName">Select Agency</label>
      <div class="input-group dropdown">
        <ejs-multiselect
          id="agencyName"
          mode="CheckBox"
          [fields]="filterOptionFields"
          [dataSource]="filterColumns.agencyName?.dataSource"
          [showDropDownIcon]="true"
          formControlName="agencyName"
          placeholder=""></ejs-multiselect>
      </div>
    </div>
    <div class="row">
      <div class="input-container">
        <label for="totalHours">Total Hours</label>
        <input
          id="totalHours"
          class="e-input"
          type="number"
          appValidateWithMessage
          formControlName="totalHours"
          maxlength="50"
          placeholder="" />
      </div>
      <div class="input-container">
        <label for="billRate">Bill Rate</label>
        <input
          id="billRate"
          class="e-input"
          type="number"
          appValidateWithMessage
          formControlName="billRate"
          maxlength="50"
          placeholder="" />
      </div>
    </div>
    <div class="input-container">
      <label for="skill">Skill</label>
      <div class="input-group dropdown">
        <ejs-multiselect
          id="skill"
          mode="CheckBox"
          [fields]="filterOptionFields"
          [dataSource]="filterColumns.skillName?.dataSource"
          [showDropDownIcon]="true"
          formControlName="skill"
          placeholder=""></ejs-multiselect>
      </div>
    </div>
  </form>
</app-filter-dialog>
<app-profile-details-container
  [currentSelectedRowIndex]="currentSelectedTableRowIndex | async"
  [maxRowIndex]="(timesheets$ | async)?.items?.length || 0"
  (nextPreviousOrderEvent)="onNextPreviousOrderEvent($event)">
</app-profile-details-container>
