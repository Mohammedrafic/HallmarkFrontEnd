<app-page-toolbar>
  <ng-container left>
    <app-timesheets-tabs
      [tabConfig]="tabConfig"
      [isDisabled]="!!(loading$ | async)"
      (changeTab)="handleChangeTab($event)">
    </app-timesheets-tabs>
  </ng-container>
  <ng-container right>
    <div *ngIf="isAgency" class="bootstrap">
      <div class="input-container">
        <ejs-dropdownlist
          appHideBeforeSyncfusionLoad
          *ngIf="organizations$ | async as organizations"
          placeholder="Select organization"
          [allowFiltering]="true"
          [dataSource]="organizations"
          [fields]="unitOrganizationsFields"
          [formControl]="organizationControl">
        </ejs-dropdownlist>
      </div>
    </div>
    <app-date-range-week-picker (range)="setRange($event)"></app-date-range-week-picker>
    <button
      ejs-button
      appHideBeforeSyncfusionLoad
      cssClass="e-outline button-filter button--no-wrap"
      (click)="showFilters()">
      <div class="filter-button-content">
        <span *ngIf="appliedFiltersAmount" class="e-badge e-badge-success e-badge-circle">{{ appliedFiltersAmount }}</span>
        Filters <i-feather name="sliders" class="icon"></i-feather>
      </div>
    </button>
  </ng-container>
</app-page-toolbar>

<section class="table-wrapper">
  <app-timesheets-table
    *ngIf="timesheets$ | async as timesheets"
    [tableData]="timesheets"
    [newSelectedIndex]="currentSelectedTableRowIndex | async"
    [activeTabIdx]="activeTabIdx"
    (changePage)="handleChangePage($event)"
    (changePerPage)="handleChangePerPage($event)"
    (timesheetRowSelected)="rowSelected($event)"
    (sortHandler)="sortHandler($event)"
    (bulkApproveEmitter)="bulkApprove($event)"
    (bulkExportEmitter)="bulkExport($event)"
  >
  </app-timesheets-table>
</section>

<app-timesheets-filter-dialog
  [activeTabIdx]="activeTabIdx"
  [isAgency]="isAgency"
  (appliedFiltersAmount)="changeFiltersAmount($event)"
  (resetFilters)="resetFilters()"
  (updateTableByFilters)="updateTableByFilters($event)"
></app-timesheets-filter-dialog>
<app-profile-details-container
  [currentSelectedRowIndex]="currentSelectedTableRowIndex | async"
  [maxRowIndex]="(timesheets$ | async)?.items?.length || 0"
  (nextPreviousOrderEvent)="onNextPreviousOrderEvent($event)">
</app-profile-details-container>
