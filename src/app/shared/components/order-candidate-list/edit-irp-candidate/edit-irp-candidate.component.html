<ejs-dialog
  #candidateDialog
  [visible]="false"
  cssClass="dialog"
  [zIndex]="1007"
  [isModal]="true"
  [width]="700"
  [animationSettings]="{ effect: 'SlideRight' }"
>
  <div class="header-candidate">
    <div class="title">
      {{title}}
    </div>
    <div class="button-group">
      <button
        ejs-button
        cssClass="e-outline close-button"
        (click)="closeModal()"
      > Cancel </button>
      <button
        ejs-button
        [isPrimary]="true"
        class="save-button"
        (click)="save()"
        [disabled]="disableSaveButton"
      > Save
      </button>
    </div>
  </div>
  <div class="form-wrapper irp-candidate" *ngIf="candidateForm">
    <div class="info-content w_100">
      <div class="message" *ngIf="candidateModelState?.candidate?.deployedUntil">
        Employee is already working on an assignment till {{candidateModelState?.candidate?.deployedUntil}}.
      </div>
      <div class="message" *ngIf="candidateModelState?.candidate?.isDeployedInSameDepartment">
        That Employee is already deployed in that Department in scope of another Order.
      </div>
    </div>
    <div>
      <form [formGroup]="candidateForm" class="form bootstrap">
        <ng-container *ngFor="let field of dialogConfig; trackBy: trackByCandidateField">
          <ng-container [ngSwitch]="field.type">

            <ng-template [ngSwitchCase]="FieldTypes.Dropdown">
             <ng-container *ngIf="field.showField">
               <div
                 *ngIf="field.field === 'reason' ?
                  candidateForm.get('isClosed')?.value && candidateModelState?.candidate?.status !== statuses.Cancelled : true"
                 class="input-container {{field?.cssClass}}">
                 <label [for]="field.field">{{ field.title }} <span *ngIf="field.required" class="required">*</span>
                 </label>
                 <div class="input-group dropdown">
                   <ejs-dropdownlist
                     appValidateWithMessage
                     [formControlName]="field.field"
                     [allowFiltering]="true"
                     [fields]="optionFields"
                     [dataSource]="field.dataSource"
                   ></ejs-dropdownlist>
                 </div>
               </div>
             </ng-container>
            </ng-template>

            <ng-template [ngSwitchCase]="FieldTypes.Date">
              <ng-container *ngIf="field.showField">
                <div
                  *ngIf="field.field === 'closeDate' ? candidateForm.get('isClosed')?.value :  field.field === 'availableStartDate' ? isAppliedorShortlisted :  field.field === 'actualStartDate' || field.field === 'actualEndDate' ? (isOnboarded || showactualStartEndDate)  :true"
                  class="input-container calendar {{field?.cssClass}}">
                  <label [for]="field.field">{{ field.title }} <span *ngIf="field.required" class="required">*</span></label>
                  <div class="input-group">
                    <ejs-datepicker
                      [id]="field.field"
                      class="datepicker"
                      [max]="field.maxDate"
                      [min]="field.minDate"
                      format="MM/dd/yyyy"
                      placeholder="MM/DD/YYYY"
                      [formControlName]="field.field"
                    ></ejs-datepicker>
                  </div>
                </div>
              </ng-container>
            </ng-template>

            <ng-template [ngSwitchCase]="FieldTypes.Toggle">
              <ng-container *ngIf="field.showField">
                <div class="input-container switch {{field?.cssClass}}" *ngIf="isOnboarded">
                  <label [for]="field.field">{{ field.title }} <span *ngIf="field.required" class="required">*</span>
                  </label>
                  <div class="input-group dropdown">
                    <ejs-switch
                      [formControlName]="field.field"
                    ></ejs-switch>
                  </div>
                </div>
              </ng-container>
            </ng-template>

          </ng-container>
        </ng-container>
      </form>
    </div>
    <app-comments-irp *ngIf="CanOrganizationViewOrdersIRP && candidateCommentContainerId" [CanOrganizationViewOrdersIRP] ="CanOrganizationViewOrdersIRP" [CanOrganizationEditOrdersIRP]="CanOrganizationEditOrdersIRP" [comments]="comments" [commentContainerId]="candidateCommentContainerId" [candidateJobId]="candidateJobId" [useBackground]="false"
      [externalCommentConfiguration]="externalCommentConfiguration"></app-comments-irp>

    <div *ngIf="showATPform && isTurnedOn">
      <form [formGroup]="AtpCalcForm" class="atpcalc-form">
        <div class="w_100">
          <div class="input-container bootstrap left atpformfield">
            <label for="billRatesCategory">Hours Worked<span class="required">*</span></label>
            <div class="input-group">
              <ejs-numerictextbox
                class="numeric-input"
                appValidateWithMessage
                min="0"
                maxlength="10"
                format="###.00"
                formControlName="hoursWorked"
                [showSpinButton]="false"
                [validateDecimalOnType]="true"
                [decimals]="2"
              >
              </ejs-numerictextbox>
            </div>
          </div>
          <div class="input-container bootstrap right atpformfield">
            <label for="billRatesCategory">Cost Saving<span class="required">*</span></label>
            <div class="input-group">
              <ejs-numerictextbox
                class="numeric-input"
                appValidateWithMessage
                min="0"
                maxlength="10"
                format="###.00"
                formControlName="costSaving"
                [showSpinButton]="false"
                [validateDecimalOnType]="true"
                [decimals]="2"
              >
              </ejs-numerictextbox>
            </div>
          </div>
          <div class="input-container bootstrap left atpformfield">
            <label for="billRatesCategory">Switcher <span class="required">*</span></label>
            <div class="input-group">
              <div class="input-group">
                <ejs-dropdownlist
                  formControlName="calculations"
                  placeholder="All"
                  [allowFiltering]="true"
                  [dataSource]="SwitcherCalcvariables"
                >
                </ejs-dropdownlist>
                </div>
            </div>
          </div>
        </div>
      </form>
      <div class="class_table">
        <table>
          <thead>
            <th>Rate Per Hour</th>
            <th>Benefit Percent of SW</th>
            <th>Wage Percent(Non-Benefit Only)</th>
          </thead>
          <tbody>
            <tr>
              <td>{{ratePerHour}}</td>
              <td>{{benefitpercentofsw}}</td>
              <td>{{wagePercent}}</td>
            </tr>
          </tbody>
        </table>

        <table>
          <thead>
            <th>Costs</th>
            <th>Salary Wages and Benefits</th>
            <th>Benefits</th>
            <th>Cost Saving</th>
            <th>Meal</th>
            <th>Lodging</th>
            <th>Stipends</th>
            <th>Adjusted Total</th>
          </thead>
          <tbody>
            <tr *ngIf="showbenefits">
              <td>Benefits</td>
              <td>{{salaryWagesandBenefits | number:'1.2-2'}}</td>
              <td>{{benefitsBenefits | number:'1.2-2'}}</td>
              <td>{{costSavingBenefits | number:'1.2-2'}}</td>
              <td>{{meal | number:'1.2-2'}}</td>
              <td>{{lodging | number:'1.2-2'}}</td>
              <td>{{stipendBenefits | number:'1.2-2'}}</td>
              <td>{{adjustedTotalBenefits | number:'1.2-2'}}</td>
            </tr>
            <tr *ngIf="shownonbenefits">
              <td>Non-Benefits</td>
              <td>{{salaryWagesandBenefits | number:'1.2-2'}}</td>
              <td>{{benefitsNonBenefits | number:'1.2-2'}}</td>
              <td>{{costSavingBenefits | number:'1.2-2'}}</td>
              <td>{{meal | number:'1.2-2'}}</td>
              <td>{{lodging | number:'1.2-2'}}</td>
              <td>{{stipendNonBenefits | number:'1.2-2'}}</td>
              <td>{{adjustedTotalNonBenefits | number:'1.2-2'}}</td>
            </tr>
          </tbody>
        </table>

        <table>
          <thead>
            <th>
              Stipend Hourly Rate
            </th>
          </thead>
          <tbody>
            <tr>
              <td>{{stipendHourlyRate | number:'1.2-2'}}</td>
            </tr>
          </tbody>
        </table>

        <table>
          <thead>
            <th colspan="2">
              Contract Labor Rate Comparision Gross
            </th>
          </thead>
          <thead>
            <th *ngIf="showbenefits">Benefit Rate</th>
            <th *ngIf="shownonbenefits">Non-Benefit Rate</th>
          </thead>
          <tbody>
            <tr>
              <td *ngIf="showbenefits">{{contractLabourBenefit  | number:'1.2-2'}}</td>
              <td *ngIf="shownonbenefits">{{contractLabourNonBenefit  | number:'1.2-2'}}</td>
            </tr>
          </tbody>
        </table>

        <table>
          <thead>
            <th colspan="2">
              Fully Loaded Blended Rate Gross
            </th>
          </thead>
          <thead>
            <th  *ngIf="showbenefits">Benefit Rate</th>
            <th *ngIf="shownonbenefits">Non-Benefit Rate</th>
          </thead>
          <tbody>
            <tr>
              <td *ngIf="showbenefits">{{fullyLoadedBenefit  | number:'1.2-2'}}</td>
              <td *ngIf="shownonbenefits">{{fullyLoadedNonBenefit  | number:'1.2-2'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="invaliderror" *ngIf="showError && isTurnedOn">
      <p> ATP Calculation cannot be displayed as there is invalid Zip-code for the location </p>
    </div>
  </div>
</ejs-dialog>

<app-replacement-pd-orders-dialog
  *ngIf="replacementPdOrdersDialogOpen"
  [closingDate]="closingDate"
  (createOrders)="setCreateReplacement($event)"
  (destroyDialog)="showReplacementPdOrdersDialog(false)"
></app-replacement-pd-orders-dialog>
