<section class="container extension-container container-tab" *ngIf="candidate$ | async as candidate">
  <section class="header-container">
    <div class="e-card-header">
      <div class="e-card-header-caption candidat-status">
        <h3 class="e-card-title candidate-title">
          {{candidate?.lastName}}, {{candidate?.firstName}}
        </h3>
        <ejs-chiplist [text]="candidate.workflowStepType.status">
          <e-chips>
            <e-chip [cssClass]="workflowStepType[candidate.workflowStepType.type] | chipsCssClass"></e-chip>
          </e-chips>
        </ejs-chiplist>
      </div>
      <div class="e-card-content button-container">
        <div class="input-group dropdown bootstrap">
          <ejs-dropdownlist
            *ngIf="!isAgency"
            [fields]="optionFields"
            [dataSource]="applicantStatuses"
            placeholder="Select Status"
            (select)="onDropDownChanged($event)"
          ></ejs-dropdownlist>
          <button
            ejs-button
            cssClass="e-primary"
            (click)="onAccept()"
            *ngIf="canAccept">
            Accept
          </button>
        </div>
      </div>
    </div>
  </section>
  <section class="content-container">
    <div class="candidate-info">
      <ejs-accordion #accordionElement expandMode="Single" openFirstAccordion>
        <e-accordionitems>
          <e-accordionitem expanded="true">
            <ng-template #header>
              <div>Job Details</div>
            </ng-template>
            <ng-template #content>
              <form [formGroup]="form">
                <div class="d-flex">
                  <div class="input-container bootstrap f-grow-2">
                    <label class="input-group">Job ID</label>
                    <div>
                      <input appValidateWithMessage formControlName="jobId" class="e-input" type="text"/>
                    </div>
                  </div>
                  <div class="input-container bootstrap">
                    <label class="input-group">Location</label>
                    <div>
                      <input appValidateWithMessage formControlName="locationName" class="e-input" type="text"/>
                    </div>
                  </div>
                </div>
                <div class="d-flex">
                    <div class="input-container bootstrap">
                      <label class="input-group">Extension Start Date</label>
                      <div class="input-group input-readonly">
                        <input appValidateWithMessage formControlName="actualStartDate" class="e-input" type="text" readonly/>
                      </div>
                    </div>
                    <div class="input-container bootstrap">
                      <label class="input-group">Extension End Date</label>
                      <div class="input-group input-readonly">
                        <input appValidateWithMessage formControlName="actualEndDate" class="e-input" type="text" readonly/>
                      </div>
                    </div>
                    <div class="input-container bootstrap">
                      <label class="input-group">Offered Bill Rate</label>
                      <div>
                        <input
                          appValidateWithMessage
                          formControlName="offeredBillRate"
                          class="e-input"
                          (focus)="priceUtils.setPriceMask(form, 'offeredBillRate', $event)"
                          (blur)="priceUtils.setTwoDecimals(form, 'offeredBillRate', $event)"
                          type="text"/>
                      </div>
                    </div>
                </div>
                <div class="d-flex" *ngIf="isAgency">
                  <div class="input-container bootstrap">
                    <label class="input-group">Leave request comments</label>
                    <div>
                      <input appValidateWithMessage formControlName="comments" class="e-input" type="text" />
                    </div>
                  </div>
                </div>
              </form>
            </ng-template>
          </e-accordionitem>
        <e-accordionitem>
          <ng-template #header>
            <div>Historical Events</div>
          </ng-template>
          <ng-template #content>
            <app-historical-events [organizationId]="candidateJob?.organizationId!" [candidateJobId]="candidate.candidateJobId" [candidateId]="candidate.candidateId" [isAgency]="isAgency"></app-historical-events>
          </ng-template>
        </e-accordionitem>
      </e-accordionitems>
      </ejs-accordion>
    </div>
    <div class="comments">
      <app-comments *ngIf="candidateJob" [comments]="comments" [commentContainerId]="candidateJob.commentContainerId || 0"></app-comments>
    </div>
  </section>
  <section class="bill-rates">
    <ng-container [ngTemplateOutlet]="isAgency ? billRates : editBillRates"></ng-container>
    <ng-template #billRates>
      <app-bill-rates-view-grid [billRatesData]="billRatesData"></app-bill-rates-view-grid>
    </ng-template>
    <ng-template #editBillRates>
      <app-bill-rates
        [billRates]="billRatesData"
        (billRatesChanged)="updateOrganizationCandidateJobWithBillRate($event)"
        [isActive]="true">
      </app-bill-rates>
    </ng-template>
  </section>
</section>
