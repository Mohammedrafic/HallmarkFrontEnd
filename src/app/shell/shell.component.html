<div class="header" [class.expanded]="sidebar?.isOpen">
  <div class="header-item">
    <i-feather *ngIf="(headerState$ | async)?.iconName" name="{{ (headerState$ | async)?.iconName }}" class="icon"></i-feather>
    <h1>{{ (headerState$ | async)?.title }}</h1>
  </div>

  <div class="stick-right header-content">
    <div class="other-icons">
      <i-feather name="help-circle" class="icon" (click)="onGetHelp()"></i-feather>
    </div>

    <div class="switcher-container" [class.hidden]="!((isOrganizationAgencyArea$ | async)?.isOrganizationArea || (isOrganizationAgencyArea$ | async)?.isAgencyArea)">
      <app-organization-agency-selector></app-organization-agency-selector>
      <div class="devider"></div>
    </div>
    <div class="bell-button" style="cursor: pointer;" (click)="bellIconClicked()">

      <i-feather name="bell" class="bell-icon"></i-feather>

      <span class="bell-button__badge">{{alerts?.length}}</span>

    </div>

    <div class="devider"></div>

    <!-- Temporary solution to log out from the application -->

    <div class="header-item">

      <button ejs-dropdownbutton [items]='profileDatasource'
              (select)="onSelectProfileMenu($event)">

        <span>{{userLogin.firstName}} {{userLogin.lastName}}</span>

      </button>

    </div>
    <!-- Temporary solution to log out from the application -->
    <!--<button class="logout-button" ejs-button cssClass="e-primary" (click)="logout()">Logout</button>-->
  </div>
</div>
<section class="shell">
  <ejs-sidebar id="sidebar" #sidebar [enableGestures]="false" [enableDock]="enableDock" [width]="width" [dockSize]="dockSize" [type]="sideBarType"
               (created)="onSideBarCreated()">
    <section class="primary-container">
      <section class="logo-container">
        <div class="logo" *ngIf="sidebar.isOpen"></div>
        <div class="small-logo" *ngIf="!sidebar.isOpen"></div>
      </section>
      <section class="collapse">
        <a class="icon-container"  #searchInputContainer>
          <i-feather name="search" class="icon"></i-feather>
          <span class="e-text">
            <input #searchInput
                   id="sidebar-nav-search-input"
                   class="nav-search-input"
                   [(ngModel)]="searchString"
                   placeholder="Start typing"
                   [value]="searchString"
                   (ngModelChange)="onSearchChange()"
                   (focus)="onSearchFocus()"
                   (focusout)="onSearchFocusOut()"
                   />
          </span>
        </a>
      </section>
      <section class="menu">
        <section class="sidebar-menu">
          <ejs-treeview id="template" #treevalidate [fields]="sideBarMenuField" (nodeClicked)='nodeSelect($event)'
                        [fullRowSelect]="true" [loadOnDemand]="false">
            <ng-template #nodeTemplate="" let-data="">
              <section appAnalyticByClick
                       [analyticData]="data.route"
                       [analyticTargetType]="'menu'"
                       [analyticEventValue]="data.title"
                       class="icon-container"
                       (click)="onMenuItemClick(data)"
                       (mouseenter)="showContextMenu(data, $event)">
                <i-feather [name]="data.icon" class="icon"></i-feather>
                <span class="e-text">{{ data.title }}</span>
                <span class=" e-badge e-badge-success e-badge-circle" *ngIf="data.count">{{ data.count }}</span>
              </section>
            </ng-template>
          </ejs-treeview>

          <ejs-contextmenu appAnalyticByClick
                           [analyticEvent]="'select'"
                           [analyticTargetType]="'menu'"
                           id='contextmenu'
                           #contextmenu
                           target='#template'
                           (onClose)="onContextMenuClose()"
                           (beforeOpen)="onBeforeContextMenuOpen($event)"
                           (select)="onSubMenuItemClick($event)"
          ></ejs-contextmenu>
        </section>
      </section>
    </section>

    <aside class="secondary-container">
      <section class="misc">
        <!--section class="theme-toggle">
          <ejs-switch class="switch" [checked]="isDarkTheme" (change)="toggleTheme()"></ejs-switch>
          <span class="e-text">Dark Theme</span> TODO: move to settings
        </!--section-->

        <section class="edu-faq">
          <a href="" class="icon-container" (click)="false">
            <i-feather name="settings" class="icon"></i-feather>
            <span class="e-text">Settings</span>
          </a>
        </section>
      </section>
      <section class="collapse">
        <a class="icon-container" (click)="toggleClick()">
          <i-feather name="sidebar" class="icon"></i-feather>
          <span class="e-text">Collapse</span>
        </a>
      </section>
    </aside>
  </ejs-sidebar>

  <section id="main">


    <div class="content">
      <router-outlet></router-outlet>
      <dashboard-search-menu #searchMenuInstance class="dashboardSearchMenus"
                             *ngIf="isSearching"
                             [isMaximized]="isMaximized"
                             [searchResult]="searchResult"
                             [searchString]="searchString"
                             (searchFocusOut)="onSearchFocusOut()"
                             [searchHeight]="searchHeight">
      </dashboard-search-menu>
    </div>
  </section>
</section>

<app-message-toast></app-message-toast>
<ejs-sidebar id="alert-sidebar" *ngIf="showAlertSidebar" #alertSidebar
  [width]="alertSidebarWidth" [type]="alertSidebarType" [position]="alertSidebarPosition"
  showBackdrop="true" style="visibility: hidden" (created)="onAlertSidebarCreated()">
  <div class="sidebar-header header-cover">
    <i-feather name="bell"></i-feather>
    <h5>
      <span>Alerts Center</span>
    </h5>
    <div class="closebtn">
      <button ejs-button id="close" class="e-btn close-btn" (click)="alertSideBarCloseClick()">
          <fa-icon [icon]='faTimes'></fa-icon>
      </button>
    </div>
  </div>
  <div id="listcontainer">
    <div class="card" *ngFor="let item of alerts">
      <div class="card-body">
        {{item.content}}
      </div>
      <div class="card-footer">
        <small>{{item.createdAt | date:'medium'}}</small>
      </div>
    </div>
  </div>
</ejs-sidebar>
